version: "3.5"

services:

  onlyoffice-logstash:
     build:
       context: elk/logstash/
       args:
          ELK_VERSION: ${ELK_VERSION:-latest}
     container_name: logstash
     volumes:
       - ./elk/logstash/config/logstash.yml:/usr/share/logstash/config/logstash.yml:ro
       - ./elk/logstash/pipeline:/usr/share/logstash/pipeline:ro
     ports:
       - "8080:8080"
     environment:
       LS_JAVA_OPTS: "-Xmx256m -Xms256m"
     networks:
       - ${NETWORK_NAME:-onlyoffice}

  onlyoffice-kibana:
     build:
       context: elk/kibana/
       args:
         ELK_VERSION: ${ELK_VERSION:-latest}
     container_name: kibana
     volumes:
       - ./elk/kibana/config/:/usr/share/kibana/config:ro
     ports:
       - "5601:5601"
     networks:
       - ${NETWORK_NAME:-onlyoffice}

networks:
  onlyoffice:
    name: ${NETWORK_NAME:-onlyoffice}
    driver: 'bridge'